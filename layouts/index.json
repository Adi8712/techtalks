{{- $index := slice -}}
{{- range where .Site.RegularPages "Type" "not in" (slice "page" "json") -}}
  {{- if and (not .Draft) (not .Params.private) -}}
    {{- $tags := .Params.tags | default (slice) -}}
    {{- $summary := .Plain | truncate 300 -}}
    {{- $index = $index | append (dict 
          "title" .Title
          "tags" $tags
          "content" $summary
          "permalink" .Permalink
          "date" (.Date.Format "2006-01-02")
    ) -}}
  {{- end -}}
{{- end -}}
{{- $index | jsonify -}}
